// Copyright 2025 Cofide Limited.
// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";

package proto.role_binding.v1alpha1;

option go_package = "github.com/cofide/cofide-api-sdk/gen/go/proto/role_binding/v1alpha1";

message RoleBinding {
  string id = 1;
  string role_id = 2;
  oneof principal {
    User user = 3;
    Group group = 4;
  }
  Resource resource = 5;
}

message User {
  // This is matched against the "sub" claim of the JWT presented by a user.
  string subject = 1;
}

message Group {
  // For users this is matched against the list of values in the "groups" claim of the JWT presented by a user.
  string claim_value = 1;
}

message Resource {
  /**
   * type can be one of the following:
   * AttestationPolicyBinding
   * AttestationPolicy
   * Cluster
   * FederatedService
   * Federation
   * Organization
   * System
   * TrustZone
   */
  string type = 1;
  string id = 2;
}
