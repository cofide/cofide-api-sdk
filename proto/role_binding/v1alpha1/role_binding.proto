// Copyright 2025 Cofide Limited.
// SPDX-License-Identifier: Apache-2.0

syntax = "proto3";

package proto.role_binding.v1alpha1;

option go_package = "github.com/cofide/cofide-api-sdk/gen/go/proto/role_binding/v1alpha1";

message RoleBinding {
  string id = 1;
  string role_id = 2;
  oneof principal {
    User user = 3;
    Group group = 4;
  }
  Resource resource = 5;
}

message User {
  // This is matched against the "sub" claim of the JWT presented by a user.
  string id = 1;
}

message Group {
  // For users this is matched against the list of values in the "groups" claim of the JWT presented by a user.
  string id = 1;
}

message Resource {
  ResourceType type = 1;
  string id = 2;
}

enum ResourceType {
  RESOURCE_TYPE_UNSPECIFIED = 0;
  RESOURCE_TYPE_AP_BINDING = 1;
  RESOURCE_TYPE_ATTESTATION_POLICY = 2;
  RESOURCE_TYPE_CLUSTER = 3;
  RESOURCE_TYPE_FEDERATED_SERVICE = 4;
  RESOURCE_TYPE_FEDERATION = 5;
  RESOURCE_TYPE_IDENTITY = 6;
  RESOURCE_TYPE_ATTESTED_NODE = 7;
  RESOURCE_TYPE_NODE_SELECTOR = 8;
  RESOURCE_TYPE_ORGANIZATION = 9;
  RESOURCE_TYPE_SYSTEM = 10;
  RESOURCE_TYPE_TRUST_ZONE = 11;
  RESOURCE_TYPE_WORKLOAD = 12;
}
